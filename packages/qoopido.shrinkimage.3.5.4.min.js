/*!
* Qoopido.js library v3.5.4, 2014-9-30
* https://github.com/dlueth/qoopido.js
* (c) 2014 Dirk Lueth
* Dual licensed under MIT and GPL
*/
!function(e,t){t.register?t.register("polyfill/object/defineproperty",e):(t.modules=t.modules||{})["polyfill/object/defineproperty"]=e()}(function(){"use strict";if(!Object.defineProperty||!function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()){var e=Object.defineProperty,t=Object.prototype.__defineGetter__,n=Object.prototype.__defineSetter__;Object.defineProperty=function(r,o,i){if(e)try{return e(r,o,i)}catch(s){}if(r!==Object(r))throw new TypeError("Object.defineProperty called on non-object");return t&&"get"in i&&t.call(r,o,i.get),n&&"set"in i&&n.call(r,o,i.set),"value"in i&&(r[o]=i.value),r}}return Object.defineProperty},window.qoopido=window.qoopido||{}),function(e,t){if(t.register){var n=[];Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()||n.push("./defineproperty"),t.register("polyfill/object/defineproperties",e,n)}else(t.modules=t.modules||{})["polyfill/object/defineproperties"]=e()}(function(){"use strict";return Object.defineProperties||(Object.defineProperties=function(e,t){if(e!==Object(e))throw new TypeError("Object.defineProperties called on non-object");var n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&Object.defineProperty(e,n,t[n]);return e}),Object.defineProperties},window.qoopido=window.qoopido||{}),function(e,t){if(t.register){var n=[];Object.defineProperties||n.push("./defineproperties"),t.register("polyfill/object/create",e,n)}else(t.modules=t.modules||{})["polyfill/object/create"]=e()}(function(){"use strict";return Object.create||(Object.create=function(e,t){function n(){}if("object"!=typeof e)throw new TypeError;n.prototype=e;var r=new n;if(e&&(r.constructor=n),arguments.length>1){if(t!==Object(t))throw new TypeError;Object.defineProperties(r,t)}return r}),Object.create},window.qoopido=window.qoopido||{}),function(e,t){t.register?t.register("polyfill/object/getownpropertynames",e):(t.modules=t.modules||{})["polyfill/object/getownpropertynames"]=e()}(function(){"use strict";return Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){if(e!==Object(e))throw new TypeError("Object.getOwnPropertyNames called on non-object");var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}),Object.getOwnPropertyNames},window.qoopido=window.qoopido||{}),function(e,t){t.register?t.register("polyfill/object/getownpropertydescriptor",e):(t.modules=t.modules||{})["polyfill/object/getownpropertydescriptor"]=e()}(function(){"use strict";if(!Object.getOwnPropertyDescriptor||!function(){try{return Object.getOwnPropertyDescriptor({x:0},"x"),!0}catch(e){return!1}}()){var e=Object.getOwnPropertyDescriptor;Object.getOwnPropertyDescriptor=function(t,n){if(t!==Object(t))throw new TypeError;try{return e.call(Object,t,n)}catch(r){}return Object.prototype.hasOwnProperty.call(t,n)?{value:t[n],enumerable:!0,writable:!0,configurable:!0}:void 0}}return Object.getOwnPropertyDescriptor},window.qoopido=window.qoopido||{}),function(e,t,n,r,o,i){"use strict";function s(e,t,s,u){var c,f=e.split("/");return p[e]?p[e]:(c=function(){if(s)for(var c,m,h=f.slice(0,-1).join("/"),g=0;(c=s[g])!==i;g++)m=d.test(c),m&&(c=a(h+"/"+c)),!p[c]&&arguments[g]&&(p[c]=arguments[g]),m&&!p[c]&&"undefined"!=typeof console&&console.error("".concat("[Qoopido.js] ",e,": Could not load dependency ",c));return p[e]=t(p,l,f,n,r,o,i),u&&u(p[e]),p[e]},void("undefined"!=typeof module&&module.exports?module.exports=define(c):"function"==typeof define&&define.amd?s?define(s,c):define(c):c()))}function u(e,t,n){s(e,t,n,function(t){p[e]=t.create()})}function a(e){for(var t;(t=e.replace(m,""))!==e;)e=t;return e.replace(h,"")}var c=t.qoopido||(t.qoopido={register:s,registerSingleton:u}),l=c.shared||(c.shared={}),p=c.modules||(c.modules={}),f=[],d=new RegExp("^\\.+\\/"),m=new RegExp("(?:\\/|)[^\\/]*\\/\\.\\."),h=new RegExp("(^\\/)|\\.\\/","g");Object.create||f.push("./polyfill/object/create"),Object.getOwnPropertyNames||f.push("./polyfill/object/getownpropertynames"),Object.getOwnPropertyDescriptor&&function(){try{return Object.getOwnPropertyDescriptor({x:0},"x"),!0}catch(e){return!1}}()||f.push("./polyfill/object/getownpropertydescriptor"),s("base",e,f)}(function(e,t,n,r,o,i,s){"use strict";function u(e){for(var t,n={},r=Object.getOwnPropertyNames(e),o=0;(t=r[o])!==s;o++)n[t]=Object.getOwnPropertyDescriptor(e,t);return n}function a(){throw new Error("[Qoopido.js] Operation prohibited")}return{create:function(){var e,t=Object.create(this,u(this));return t._constructor&&(e=t._constructor.apply(t,arguments)),t.create=t.extend=a,e||t},extend:function(e,t){var n;return e=e||{},t=t===!0,e._parent=this,n=Object.create(this,u(e)),t===!0&&(n.extend=a),n}}},this,navigator,window,document),function(e){window.qoopido.register("polyfill/string/ucfirst",e)}(function(){"use strict";return String.prototype.ucfirst||(String.prototype.ucfirst=function(){var e=this;return e.charAt(0).toUpperCase()+e.slice(1)}),String.prototype.ucfirst}),function(e){window.qoopido.register("polyfill/string/lcfirst",e)}(function(){"use strict";return String.prototype.lcfirst||(String.prototype.lcfirst=function(){var e=this;return e.charAt(0).toLowerCase()+e.slice(1)}),String.prototype.lcfirst}),function(e){window.qoopido.register("polyfill/window/getcomputedstyle",e)}(function(e,t,n,r,o){"use strict";if(o.getComputedStyle)return o.getComputedStyle;var i=new RegExp("(\\-([a-z]){1})","g"),s=function(){return arguments[2].toUpperCase()};return function(e){var t=this;return t.getPropertyValue=function(t){return"float"===t&&(t="styleFloat"),i.test(t)&&(t=t.replace(i,s)),e.currentStyle[t]||null},t}}),function(e){window.qoopido.register("polyfill/window/promise",e)}(function(e,t,n,r,o,i,s){"use strict";function u(e,t){var n=_.push([e,t]);1===n&&a()}function a(){o.setTimeout(c,1)}function c(){for(var e,t=0;(e=_[t])!==s;t++)e[0](e[1]);_.length=0}function l(e,t){var n,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(("function"==typeof t||"object"==typeof t&&null!==t)&&(r=t.then,"function"==typeof r))return r.call(t,function(r){return n?!0:(n=!0,void(t!==r?d(e,r):m(e,r)))},function(t){return n?!0:(n=!0,void h(e,t))}),!0}catch(o){return n?!0:(h(e,o),!0)}return!1}function p(e,t){function n(e){d(t,e)}function r(e){h(t,e)}try{e(n,r)}catch(o){r(o)}}function f(e,t,n,r){var o,i,s,u,a="function"==typeof n;if(a)try{o=n(r),s=!0}catch(c){u=!0,i=c}else o=r,s=!0;l(t,o)||(a&&s?d(t,o):u?h(t,i):e===P?d(t,o):e===E&&h(t,o))}function d(e,t){e===t?m(e,t):l(e,t)||m(e,t)}function m(e,t){e._state===x&&(e._state=j,e._detail=t,u(g,e))}function h(e,t){e._state===x&&(e._state=j,e._detail=t,u(y,e))}function g(e){w(e,e._state=P)}function y(e){w(e,e._state=E)}function v(e,t,n,r){var o=e._subscribers,i=o.length;o[i]=t,o[i+P]=n,o[i+E]=r}function w(e,t){for(var n,r,o=e._subscribers,i=e._detail,u=0;(n=o[u])!==s;u+=3)r=o[u+t],f(t,n,r,i);e._subscribers=null}function b(e){var t=this;if("function"!=typeof e)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");t._subscribers=[],p(e,t)}var x=void 0,j=0,P=1,E=2,_=[];return b.prototype={_state:s,_detail:s,_subscribers:s,then:function(e,t){var n=this,r=new b(function(){});return n._state?u(function(){f(n._state,r,arguments[n._state-1],n._detail)}):v(n,r,e,t),r},"catch":function(e){return this.then(null,e)}},o.Promise||(o.Promise=b),o.Promise}),function(e){var t=[];window.Promise||t.push("../polyfill/window/promise"),window.qoopido.register("promise/all",e,t)}(function(e,t,n,r,o,i,s){"use strict";return function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("You must pass an array to all.");return new o.Promise(function(t,n){function r(e){return function(t){o(e,t)}}function o(e,n){u[e]=n,0===--a&&t(u)}var i,u=[],a=e.length,c=0;for(0===a&&t([]);(i=e[c])!==s;c++)i&&"function"==typeof i.then?i.then(r(c),n):o(c,i)})}}),function(e){var t=[];window.Promise||t.push("../polyfill/window/promise"),window.qoopido.register("promise/defer",e,t)}(function(e,t,n,r,o){"use strict";return function(){var e=this;e.promise=new o.Promise(function(t,n){e.resolve=t,e.reject=n})}}),function(e){window.qoopido.register("function/merge",e)}(function(e,t,n,r,o,i,s){"use strict";return function u(){var e,t,n,r,o,i=arguments[0];for(e=1;(t=arguments[e])!==s;e++)for(n in t)r=i[n],o=t[n],o!==s&&(null!==o&&"object"==typeof o?(r=o.length!==s?r&&"object"==typeof r&&r.length!==s?r:[]:r&&"object"==typeof r&&r.length===s?r:{},i[n]=u(r,o)):i[n]=o);return i}}),function(e){window.qoopido.register("function/unique/string",e)}(function(){"use strict";function e(e){var t="",r=0;for(e=parseInt(e,10)||12;e>r;r++)t+=n[parseInt(Math.random()*(n.length-1),10)];return t}var t={},n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");return function(n){var r;do r=e(n);while("undefined"!=typeof t[r]);return t[r]=!0,r}}),function(e){window.qoopido.register("function/unique/uuid",e)}(function(){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(n,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}var t={},n=new RegExp("[xy]","g");return function(){var n;do n=e();while("undefined"!=typeof t[n]);return t[n]=!0,n}}),function(e){window.qoopido.register("proxy",e,["./base","./function/unique/uuid"])}(function(e){"use strict";return e.base.extend({_constructor:function(t,n){var r=Array.prototype.splice.call(arguments,2),o=function(){return n.apply(t,Array.prototype.slice.call(arguments).concat(r))};return o._quid=e["function/unique/uuid"](),o}})}),function(e){var t=["./base","./promise/all","./promise/defer"];String.prototype.ucfirst||t.push("./polyfill/string/ucfirst"),String.prototype.lcfirst||t.push("./polyfill/string/lcfirst"),window.qoopido.registerSingleton("support",e,t)}(function(e,t,n,r,o,i,s){"use strict";function u(e){return e.replace(p,"$1").lcfirst().replace(f,"").replace(d,h)}var a=e["promise/all"],c=e["promise/defer"],l=new RegExp("^(Moz|WebKit|Khtml|ms|O|Icab)(?=[A-Z])"),p=new RegExp("^(?:webkit|khtml|icab|moz|ms|o)([A-Z])"),f=new RegExp("^-(?:webkit|khtml|icab|moz|ms|o)-"),d=new RegExp("-([a-z])","gi"),m=new RegExp("([A-Z])","g"),h=function(){return arguments[1].ucfirst()},g={prefix:null,method:{},property:{},css:{},promises:{prefix:null,method:{},property:{},css:{},test:{}}};return e.base.extend({test:{},pool:t.pool&&t.pool.dom,testMultiple:function(){for(var e,t=[],n=0;(e=arguments[n])!==s;n++)switch(typeof e){case"string":t.push(this.test[e]());break;case"boolean":var r=new c;e?r.resolve():r.reject(),t.push(r.promise);break;default:t.push(e)}return new a(t)},getPrefix:function(){var e,t=this,n=g.prefix||null;if(null===n){var r=t.pool?t.pool.obtain("div"):i.createElement("div"),o=r.style;n=!1;for(e in o)l.test(e)&&(n=e.match(l)[0]);n===!1&&"WebkitOpacity"in o&&(n="WebKit"),n===!1&&"KhtmlOpacity"in o&&(n="Khtml"),n=g.prefix=n===!1?!1:[n.toLowerCase(),n.toLowerCase().ucfirst(),n],r.dispose&&r.dispose()}return n},getMethod:function(e,t){e=u(e),t=t||o;var n=t.tagName,r=g.method[n]=g.method[n]||{},i=r[e]=g.method[n][e]||null;if(null===i){i=!1;var a,c,l=0,p=e.ucfirst(),f=this.getPrefix();for(a=f!==!1?(e+" "+f.join(p+" ")+p).split(" "):[e];(c=a[l])!==s;l++)if(t[c]!==s&&("function"==typeof t[c]||"object"==typeof t[c])){i=c;break}g.method[n][e]=i}return i},getProperty:function(e,t){e=u(e),t=t||o;var n=t.tagName,r=g.property[n]=g.property[n]||{},i=r[e]=g.property[n][e]||null;if(null===i){i=!1;var a,c,l=0,p=e.ucfirst(),f=this.getPrefix();for(a=f!==!1?(e+" "+f.join(p+" ")+p).split(" "):[e],l;(c=a[l])!==s;l++)if(t[c]!==s){i=c;break}g.property[n][e]=i}return i},getCssProperty:function(e){e=u(e);var t=this,n=g.css[e]||null;if(null===n){n=!1;var r,o=0,a=t.pool?t.pool.obtain("div"):i.createElement("div"),c=e.ucfirst(),l=this.getPrefix()||[],p=(e+" "+l.join(c+" ")+c).split(" "),f="";for(o;(r=p[o])!==s;o++)if(a.style[r]!==s){n=r,o>0&&(f="-");break}n=g.css[e]=n!==!1?[f+n.replace(m,"-$1").toLowerCase(),n]:!1,a.dispose&&a.dispose()}return n},supportsPrefix:function(){return!!this.getPrefix()},supportsMethod:function(e,t){return!!this.getMethod(e,t)},supportsProperty:function(e,t){return!!this.getProperty(e,t)},supportsCssProperty:function(e){return!!this.getCssProperty(e)},testPrefix:function(){var e=g.promises.prefix;if(null===e){var t=new c,n=this.getPrefix();n?t.resolve(n):t.reject(),e=g.promises.prefix=t.promise}return e},testMethod:function(e,t){t=t||o;var n=t.tagName,r=g.promises.method[n]=g.promises.method[n]||{},i=r[e]=g.promises.method[n][e]||null;if(null===i){var s=new c,u=this.getMethod(e,t);u?s.resolve(u):s.reject(),i=g.promises.method[n][e]=s.promise}return i},testProperty:function(e,t){t=t||o;var n=t.tagName,r=g.promises.property[n]=g.promises.property[n]||{},i=r[e]=g.promises.property[n][e]||null;if(null===i){var s=new c,u=this.getProperty(e,t);u?s.resolve(u):s.reject(),i=g.promises.property[n][e]=s.promise}return i},testCssProperty:function(e){var t=g.promises.css[e]||null;if(null===t){var n=new c,r=this.getCssProperty(e);r?n.resolve(r):n.reject(),t=g.promises.css[e]=n.promise}return t},addTest:function(e,t){return this.test[e]=function(){var n=g.promises.test[e]||null;if(null===n){var r=new c,o=Array.prototype.slice.call(arguments);o.splice(0,0,r),t.apply(null,o),n=g.promises.test[e]=r.promise}return n}}})}),function(e){window.qoopido.register("support/capability/datauri",e,["../../support","../../dom/element"])}(function(e,t,n,r,o,i){"use strict";var s=e.support;return s.addTest("/capability/datauri",function(t){var n=e["dom/element"].create(s.pool?s.pool.obtain("img"):i.createElement("img"));n.one("error load",function(e){"load"===e.type&&1===n.element.width&&1===n.element.height?t.resolve():t.reject(),n.element.dispose&&n.element.dispose()},!1).setAttribute("src","data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==")})}),function(e){window.qoopido.register("support/element/canvas",e,["../../support"])}(function(e,t,n,r,o,i){"use strict";var s=e.support;return s.addTest("/element/canvas",function(e){var t=s.pool?s.pool.obtain("canvas"):i.createElement("canvas");t.getContext&&t.getContext("2d")?e.resolve():e.reject(),t.dispose&&t.dispose()})}),function(e){window.qoopido.register("support/element/canvas/todataurl",e,["../../../support","../canvas"])}(function(e,t,n,r,o,i,s){"use strict";var u=e.support;return u.addTest("/element/canvas/todataurl",function(t){e["support/element/canvas"]().then(function(){var e=u.pool?u.pool.obtain("canvas"):i.createElement("canvas");e.toDataURL!==s?t.resolve():t.reject(),e.dispose&&e.dispose()},function(){t.reject()})})}),function(e){window.qoopido.register("support/element/canvas/todataurl/png",e,["../../../../support","../todataurl"])}(function(e,t,n,r,o,i){"use strict";var s=e.support;return s.addTest("/element/canvas/todataurl/png",function(t){e["support/element/canvas/todataurl"]().then(function(){var e=s.pool?s.pool.obtain("canvas"):i.createElement("canvas");0===e.toDataURL("image/png").indexOf("data:image/png")?t.resolve():t.reject(),e.dispose&&e.dispose()},function(){t.reject()})})}),function(e){window.qoopido.registerSingleton("hook/event",e,["../base"])}(function(e,t,n,r,o,i,s){"use strict";function u(e,t,n){for(var r,o=0;(r=n[o])!==s;o++)e[r]=t[r];e._properties=e._properties.concat(n)}var a={general:{properties:"type altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),process:function(e,t){e.originalEvent=t,e.metaKey=t.metaKey&&t.metaKey!==!1?!0:!1,e.target||(e.target=t.srcElement||i),3===e.target.nodeType&&(e.target=e.target.parentNode)}},mouse:{regex:new RegExp("^(?:mouse|pointer|contextmenu|touch)|click"),properties:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement relatedTarget which".split(" "),process:function(e,t){var n,r,o;r=t.fromElement,o=t.button,null===e.pageX&&null!==t.clientX&&(n=e.target.ownerDocument||i,n=n.documentElement||n.body,e.pageX=t.clientX+(n.scrollLeft||0)-(n.clientLeft||0),e.pageY=t.clientY+(n.scrollTop||0)-(n.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||o===s||(e.which=1&o?1:2&o?3:4&o?2:0)}},key:{regex:new RegExp("^key"),properties:"char charCode key keyCode which".split(" "),process:function(e,t){null===e.which&&(e.which=null!==t.charCode?t.charCode:t.keyCode)}}};return e.base.extend({add:function(e,t){return e&&t&&a[e]&&(a[e]=t),this},get:function(e){return e&&a[e]?a[e]:null},process:function(e,t){var n,r,o;for(n in a)r=a[n],o=!r.regex||r.regex.test(t.type),o&&(r.properties&&u(e,t,r.properties),r.process&&r.process(e,t),r.delegate&&(e.delegate=r.delegate))}})}),function(e){var t=["../base","../support"];window.getComputedStyle||t.push("../polyfill/window/getcomputedstyle"),window.qoopido.registerSingleton("hook/css",e,t)}(function(e,t,n,r,o){"use strict";var i=e.support,s=o.getComputedStyle||e["polyfill/window/getcomputedstyle"],u={general:{get:function(e,t){return s(e,null).getPropertyValue(t)},set:function(e,t,n){e.style[t]=n}},opacity:i.supportsCssProperty("opacity")?null:{regex:new RegExp("alpha\\(opacity=(.*)\\)","i"),get:function(e,t,n){return n=s(e,null).getPropertyValue("filter").toString().match(this.regex),n=n?n[1]/100:1},set:function(e,t,n){var r=e.style;r.zoom=1,r.filter="alpha(opacity="+(100*n+.5>>0)+")"}}};return e.base.extend({add:function(e,t){return e&&t&&u[e]&&(u[e]=t),this},get:function(e){return e&&u[e]?u[e]:null},process:function(e,t,n,r){var o;return n=i.getCssProperty(n,t)[1]||null,n?((o=this.get(n))&&o[e]||this.get("general")[e])(t,n,r):void 0}})}),function(e){window.qoopido.register("dom/event",e,["../base","../hook/event"])}(function(e,t,n,r,o,i,s){"use strict";var u=e["hook/event"];return e.base.extend({originalEvent:null,isDelegate:!1,isDefaultPrevented:!1,isPropagationStopped:!1,isImmediatePropagationStopped:!1,_properties:null,_constructor:function(e){var t=this;t._properties=[],t._obtain(e)},_obtain:function(e){u.process(this,e)},_dispose:function(){for(var e,t=this,n=0;(e=t._properties[n])!==s;n++)delete t[e];delete t.delegate,t.originalEvent=null,t.isDelegate=!1,t.isDefaultPrevented=!1,t.isPropagationStopped=!1,t.isImmediatePropagationStopped=!1,t._properties.length=0},preventDefault:function(){var e=this,t=e.originalEvent;t.cancelable!==!1&&(e.isDefaultPrevented=!0,t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var e=this,t=e.originalEvent;e.isPropagationStopped=!0,t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0},stopImmediatePropagation:function(){var e=this,t=e.originalEvent;e.isImmediatePropagationStopped=!0,t.stopImmediatePropagation&&t.stopImmediatePropagation(),e.stopPropagation()}})}),function(e){var t=["../base","../function/unique/uuid","../hook/css","./event"];window.CustomEvent||t.push("../polyfill/window/customevent"),window.addEventListener||t.push("../polyfill/window/addeventlistener"),window.removeEventListener||t.push("../polyfill/window/removeeventlistener"),window.dispatchEvent||t.push("../polyfill/window/dispatchevent"),Element.prototype.matches||t.push("../polyfill/element/matches"),document.querySelector||t.push("../polyfill/document/queryselector"),document.querySelectorAll||t.push("../polyfill/document/queryselectorall"),window.qoopido.register("dom/element",e,t)}(function(e,t,n,r,o,i,s){"use strict";function u(e,t,n){var r=this,o=i.createEvent("CustomEvent");o.initCustomEvent(e,"load"===e?!1:!0,!0,t),n&&(o._quid=n,o.isDelegate=!0),r.element.dispatchEvent(o)}function a(e){var t;if("string"==typeof e)try{d.test(e)===!0?(t=e.replace(d,"$1").toLowerCase(),e=i.createElement(t)):e=i.querySelector(e)}catch(n){e=null}if(!e)throw new Error("[Qoopido.js] Element could not be resolved");return e}var c="object",l="string",p=e["function/unique/uuid"],f="textContent"in i.createElement("a")?"textContent":"innerText",d=new RegExp("^<(\\w+)\\s*/>$"),m=new RegExp("^[^-]+"),h=e["pool/module"]&&e["pool/module"].create(e["dom/event"],null,!0)||null,g={},y=e["hook/css"];return e.base.extend({type:null,element:null,_listener:null,_constructor:function(e,t,n){var r=this;e=a(e),r.type=e.tagName,r.element=e,r._listener=r._listener||{},"object"==typeof t&&null!==t&&r.setAttributes(t),"object"==typeof n&&null!==n&&r.setStyles(n)},_obtain:function(e,t,n){this._constructor(e,t,n)},_dispose:function(){var e,t,n=this;for(e in n._listener)t=e.match(m),n.element.removeEventListener(t,n._listener[e]),delete n._listener[e];n.type=null,n.element=null},getContent:function(e){var t=this.element;return e&&e!==!1?t.innerHTML:t[f]},setContent:function(e,t){var n=this,r=n.element;return t&&t!==!1?r.innerHTML=e:r[f]=e,n},getAttribute:function(e){var t=this;return e&&typeof e===l?t.element.getAttribute(e):void 0},getAttributes:function(e){var t,n=this,r={},o=0;if(e)for(e=typeof e===l?e.split(" "):e;(t=e[o])!==s;o++)r[t]=n.element.getAttributes(t);return r},setAttribute:function(e,t){var n=this;return e&&typeof e===l&&n.element.setAttribute(e,t),n},setAttributes:function(e){var t,n=this;if(e&&typeof e===c&&!e.length)for(t in e)n.element.setAttribute(t,e[t]);return n},removeAttribute:function(e){var t=this;return e&&typeof e===l&&t.element.removeAttribute(e),t},removeAttributes:function(e){var t,n=this,r=0;if(e)for(e=typeof e===l?e.split(" "):e;(t=e[r])!==s;r++)n.element.removeAttribute(t);return n},getStyle:function(e){var t=this;return e&&typeof e===l?y.process("get",t.element,e):void 0},getStyles:function(e){var t,n=this,r={},o=0;if(e)for(e=typeof e===l?e.split(" "):e;(t=e[o])!==s;o++)r[t]=y.process("get",n.element,t);return r},setStyle:function(e,t){var n=this;return e&&typeof e===l&&y.process("set",n.element,e,t),n},setStyles:function(e){var t,n=this;if(e&&typeof e===c&&!e.length)for(t in e)y.process("set",n.element,t,e[t]);return n},removeStyle:function(e){var t=this;return e&&typeof e===l&&t.setStyle(e,""),t},removeStyles:function(e){var t,n=this,r=0;if(e)for(e=typeof e===l?e.split(" "):e;(t=e[r])!==s;r++)n.setStyle(t,"");return n},siblings:function(e){for(var t=this.element,n=t.parentNode.firstChild,r=[];n;n=n.nextSibling)1===n.nodeType&&n!==t&&(!e||n.matches(e))&&r.push(n);return r},siblingsBefore:function(e){for(var t=this.element.previousSibling,n=[];t;t=t.previousSibling)1===t.nodeType&&(!e||t.matches(e))&&n.push(t);return n},siblingsAfter:function(e){for(var t=this.element.nextSibling,n=[];t;t=t.nextSibling)1===t.nodeType&&(!e||t.matches(e))&&n.push(t);return n},previous:function(e){var t;if(!e)return this.element.previousSibling;for(t=this.element.previousSibling;t;t=t.previousSibling)if(1===t.nodeType&&t.matches(e))return t},next:function(e){var t;if(!e)return this.element.nextSibling;for(t=this.element.nextSibling;t;t=t.nextSibling)if(1===t.nodeType&&t.matches(e))return t},find:function(e){return this.element.querySelectorAll(e)},parent:function(e){var t;if(!e)return this.element.parentNode;for(t=this.element;t;t=t.parentNode)if(t.matches(e))return t},parents:function(e){for(var t=this.element.parentNode,n=[];t;t=t.parentNode){if(9===t.nodeType)return n;1===t.nodeType&&(!e||t.matches(e))&&n.push(t)}},isVisible:function(){var e=this.element;return!(e.offsetWidth<=0&&e.offsetHeight<=0)},hasClass:function(e){return e?new RegExp("(?:^|\\s)"+e+"(?:\\s|$)").test(this.element.className):!1},addClass:function(e){var t,n=this;return e&&!n.hasClass(e)&&(t=n.element.className.split(" "),t.push(e),n.element.className=t.join(" ")),n},removeClass:function(e){var t=this;return e&&t.hasClass(e)&&(t.element.className=t.element.className.replace(new RegExp("(?:^|\\s)"+e+"(?!\\S)"))),t},toggleClass:function(e){var t=this;return e&&(t.hasClass(e)?t.removeClass(e):t.addClass(e)),t},prepend:function(e){var t=this,n=t.element;if(e)try{e=e.element||a(e),n.firstChild?n.insertBefore(e,n.firstChild):t.append(e)}catch(r){n.insertAdjacentHTML("afterBegin",e)}return t},append:function(e){var t=this,n=t.element;if(e)try{n.appendChild(e.element||a(e))}catch(r){n.insertAdjacentHTML("beforeEnd",e)}return t},prependTo:function(e){var t=this,n=t.element;return e&&((e=e.element||a(e)).firstChild?e.insertBefore(n,e.firstChild):t.appendTo(e)),t},appendTo:function(e){var t=this;return e&&(e.element||a(e)).appendChild(t.element),t},insertBefore:function(e){var t=this,n=t.element;return e&&(e=e.element||a(e)).parentNode.insertBefore(n,e),t},insertAfter:function(e){var t=this,n=t.element;return e&&((e=e.element||a(e)).nextSibling?e.parentNode.insertBefore(n,e.nextSibling):t.appendTo(e.parentNode)),t},replace:function(e){var t=this,n=t.element;return e&&(e=e.element||a(e)).parentNode.replaceChild(n,e),t},replaceWith:function(e){var t=this,n=t.element;return e&&(e=e.element||a(e),n.parentNode.replaceChild(e,n)),t},hide:function(){return this.setStyle("display","none")},show:function(){return this.removeStyle("display")},remove:function(){var e=this,t=e.element;return t.parentNode.removeChild(t),e},on:function(t){var n,r=this,i=r.element,a=arguments.length>2?arguments[1]:null,c=arguments.length>2?arguments[2]:arguments[1],l=c._quid||(c._quid=p()),f=0;for(t=t.split(" ");(n=t[f])!==s;f++){var d=n+"-"+l,m=function(t){var n,i=t._quid||(t._quid=p());g[i]||(g[i]=h&&h.obtain(t)||e["dom/event"].create(t)),t=g[i],n=t.delegate,o.clearTimeout(t._timeout),(!a||t.target.matches(a))&&c.call(t.target,t,t.originalEvent.detail),n&&(delete t.delegate,u.call(r,n,null,t._quid)),t._timeout=o.setTimeout(function(){delete g[i],delete t._timeout,t.dispose&&t.dispose()},5e3)};m.type=n,r._listener[d]=m,i.addEventListener(n,m)}return r},one:function(e){var t=this,n=arguments.length>3||"string"==typeof arguments[1]?arguments[1]:null,r=arguments.length>3||"function"==typeof arguments[2]?arguments[2]:arguments[1],o=(arguments.length>3?arguments[3]:arguments[2])!==!1,i=function(n){t.off(o===!0?n.type:e,i),r.call(t,n,n.originalEvent.detail)};return r._quid=i._quid=p(),n?t.on(e,n,i):t.on(e,i),t},off:function(e,t){var n,r,o,i=this,u=i.element,a=0;for(e=e.split(" ");(n=e[a])!==s;a++)r=t._quid&&n+"-"+t._quid||null,o=r&&i._listener[r]||null,o?(u.removeEventListener(n,o),delete i._listener[r]):u.removeEventListener(n,t);return i},emit:function(e,t){var n=this;return u.call(n,e,t),n}})}),function(e){window.qoopido.registerSingleton("url",e,["./base"])}(function(e,t,n,r,o,i){"use strict";function s(e){var t=i.createElement("a");return t.href=e||"",t}var u,a,c=new RegExp("[?&]?([^=]+)=([^&]*)","g");try{u=location}catch(l){u=s()}return a=new RegExp("".concat("^",u.protocol,"//",u.hostname),"i"),e.base.extend({resolve:function(e){return s(e).href},redirect:function(e,t){t=t||o,t.location.href=this.resolve(e)},getParameter:function(e){for(var t,n={},r=s(e).search.split("+").join(" ");t=c.exec(r);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},isLocal:function(e){return a.test(this.resolve(e))}})}),function(e){window.qoopido.register("transport",e,["./base","./function/merge"])}(function(e){"use strict";var t;return t=e.base.extend({setup:function(t){var n=this;return n._settings=e["function/merge"]({},n._settings,t),n},serialize:function(e,t){var n,r,o,i=[];for(n in e)r=t?"".concat(t,"[",n,"]"):n,o=e[n],i.push("object"==typeof o?this.serialize(o,r):"".concat(encodeURIComponent(r),"=",encodeURIComponent(o)));return i.join("&")}})},window,document),function(e){window.qoopido.registerSingleton("transport/xhr",e,["../transport","../function/merge","../function/unique/string","../url","../promise/defer"])}(function(e,t,n,r,o,i,s){"use strict";function u(e,t,n){var r,o=this,i=o.xhr,s=o.settings;n=n&&"object"==typeof n?o.serialize(n):n,t=s.cache===!1?"".concat(t,t.indexOf("?")>-1?"&":"?","_="+(new Date).getTime()):t,t=n&&"GET"===e?"".concat(t,t.indexOf("?")>-1?"&":"?",n):t;for(r in s.xhrOptions)i[r]=s.xhrOptions[r];if(i.open(e,t,s.async,s.username,s.password),i.setRequestHeader){i.setRequestHeader("Accept",s.accept),n&&"GET"!==e&&i.setRequestHeader("Content-Type",s.contentType);for(r in s.header)i.setRequestHeader(r,s.header[r])}i.timeout=s.timeout,i.onprogress=function(e){a.call(o,e)},i.onreadystatechange=i.onload=function(){c.call(o)},i.onerror=function(){l.call(o)},i.send(n||null),o.timeout=setTimeout(function(){p.call(o)},s.timeout)}function a(){var e=this;e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(function(){p.call(e)},e.settings.timeout)}function c(){var e=this,t=e.xhr,n=e.dfd;(t.readyState===s||4===t.readyState)&&(f.call(e),t.status===s||200===t.status?n.resolve({data:t.responseText,xhr:t}):n.reject({status:t.status,xhr:t}))}function l(){var e=this;f.call(e),e.dfd.reject()}function p(){var e=this;e.xhr.abort(),f.call(e),e.dfd.reject()}function f(){var e=this,t=e.xhr;e.timeout&&clearTimeout(e.timeout),t.onprogress=t.onreadystatechange=t.onerror=null}var d,m=e["promise/defer"],h="undefined"!=typeof o.XMLHttpRequest?function(t){return e.url.isLocal(t)?new o.XMLHttpRequest:o.XDomainRequest?new o.XDomainRequest:new o.XMLHttpRequest}:function(){try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}};return d=e.transport.extend({_settings:{accept:"*/*",timeout:5e3,async:!0,cache:!1,header:{},username:null,password:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8 ",xhrOptions:{}},load:function(t,n,r,o){var i={};return n=e.url.resolve(n),i.url=n,i.id="".concat("xhr-",e["function/unique/string"]()),i.dfd=new m,i.xhr=h(n),i.settings=e["function/merge"]({},this._settings,o),i.timeout=null,u.call(i,t.toUpperCase(),n,r),i.dfd.promise},get:function(e,t,n){return this.load("GET",e,t,n)},post:function(e,t,n){return this.load("POST",e,t,n)},put:function(e,t,n){return this.load("PUT",e,t,n)},"delete":function(e,t,n){return this.load("DELETE",e,t,n)},head:function(e,t,n){return this.load("HEAD",e,t,n)}})},window,document),function(e){var t=["../element","../../proxy","../../function/merge","../../url","../../support","../../support/capability/datauri","../../support/element/canvas/todataurl/png","../../transport/xhr"];window.qoopido.register("dom/element/shrinkimage",e,t)}(function(e,t,n,r,o,i){"use strict";function s(t,n){t=e.url.resolve(w.exec(t)[1]),n=n===!0;var r=this,o=e["function/merge"]({},r._settings,e.url.getParameter(t)),i=o.target||(t=t.split("?")[0]).replace(b,"".concat(".q",o.quality,".shrunk"));n||r.removeAttribute(r._settings.attribute).hide(),x.then(function(){if(o.debug===!0)throw new Error("[Qoopido.js] Debug enabled");switch(typeof y[i]){case"object":y[i].one(E,function(e){u.call(r,e.data,n)}),r.emit(j);break;case"string":u.call(r,y[i],n);break;default:y[i]=f.create(i,n?null:r.element).one(O,function(e,o){e.type===E?(y[i]=o,r.emit(P),u.call(r,o,n)):(y[i]=t,u.call(r,t,n))},!1)}})["catch"](function(){y[i]=t,u.call(r,t,n)})}function u(e,t){var n=this;t?(n.setStyle("backgroundImage","url("+e+")"),n.emit(E)):n.one(q,function(){n.show(),n.emit(E)}).setAttribute("src",e)}function a(e){var t=this;e.get(t._url).then(function(e){try{var n=d.parse(e.data);n.width=parseInt(n.width,10),n.height=parseInt(n.height,10),c.call(t,n)}catch(r){t.emit(_)}},function(){t.emit(_)})}function c(e){var t,n,r=this,o=function(o){return t=g&&g.obtain("canvas")||i.createElement("canvas"),t.style.display="none",t.width=e.width,t.height=e.height,n=t.getContext("2d"),n.clearRect(0,0,e.width,e.height),n.drawImage(r.element,0,0,e.width,e.height),r.one(q,s).setAttribute("src",e.alpha),l(o)},s=function(o){var i;return n.globalCompositeOperation="xor",n.drawImage(r.element,0,0,e.width,e.height),i=t.toDataURL("image/png"),u(),r.emit(E,i),l(o)},u=function(){t&&t.dispose&&t.dispose(),r.element.dispose&&r.element.dispose()};r.one(A,function(e){e.type===q?o.call(this,e):(u(),r.emit(_))},!1).setAttribute("src",e.main)}function l(e){return e.preventDefault(),e.stopPropagation(),!1}var p,f,d=o.JSON,m=n.pop(),h={attribute:"data-"+m,quality:80,debug:!1},g=t.pool&&t.pool.dom||null,y={},v=new RegExp('^url\\x28"{0,1}data:image/shrink,(.+?)"{0,1}\\x29$',"i"),w=new RegExp('^(?:url\\x28"{0,1}|)(?:data:image/shrink,|)(.+?)(?:"{0,1}\\x29|)$',"i"),b=new RegExp("\\.png$","i"),x=e.support.testMultiple("/capability/datauri","/element/canvas/todataurl/png"),j="queued",P="cached",E="loaded",_="failed",O="".concat(E," ",_),q="load",S="error",A="".concat(q," ",S);
return p=e["dom/element"].extend({_constructor:function(t,n){var r,o,i=this;p._parent._constructor.call(i,t),i._settings=n=e["function/merge"]({},h,n),r=i.getAttribute(n.attribute),o=i.getStyle("backgroundImage"),"IMG"===i.type&&s.call(i,r),"none"!==o&&v.test(o)&&s.call(i,o,!0)},hide:function(){this.setStyles({visibility:"hidden",opacity:0})},show:function(){this.setStyles({visibility:"",opacity:""})}}),f=e["dom/element"].extend({_url:null,_constructor:function(t,n){var r=this;n||(n=g&&g.obtain("img")||i.createElement("img")),f._parent._constructor.call(r,n),r._url=t,a.call(r,e["transport/xhr"])}}),p},window);