(function(e,t,n,r){"use strict";function o(){return[].push.apply(arguments,[t,n,r]),t[i]=t[i]||{},t[i][s]=e.apply(null,arguments)}var i="qoopido",s="worker";typeof define=="function"&&define.amd?define(["./base","./support","q"],o):o(t[i].base,t[i].support,t.Q)})(function(e,t,n,r,i,s){"use strict";var o=t.supportsMethod("Worker");return e.extend({execute:function(t,r,i){var s=n.defer();i=i||[];if(o===!0){var u=new Worker(t);u.addEventListener("message",function(e){switch(e.data.type){case"progress":s.notify(e.data.progress);break;case"result":s.resolve(e.data.result)}},!1),u.addEventListener("error",function(e){s.reject(e)},!1),u.postMessage({func:r.toString(),args:i})}else setTimeout(function(){try{s.resolve(r.apply(null,i))}catch(e){s.reject()}},0);return s.promise}})},window,document);