(function(e,t){"use strict";var r="qoopido/xhr",n=function n(){return t.qoopido.shared.prepareModule(r,e,arguments,!0)};"function"==typeof define&&define.amd?define(["qoopido/base","qoopido/unique","q"],n):n(t.qoopido.base,t.qoopido.unique,t.Q)})(function(e,t,r,n){"use strict";function o(){if(n.XMLHttpRequest)return new n.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}}function i(e,t,r){var n=this,o=n.xhr;r="object"==typeof r?p(r):r,t=r&&"GET"===e?"".concat(t,t.indexOf("?")>-1?"&":"?",r):t,o.open(e,t,!0,null,null),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&"GET"!==e&&o.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8 "),o.setRequestHeader("Accepts","application/json"),o.timeout=5200,o.onprogress=function(){u.apply(n)},o.onreadystatechange=function(){a.apply(n)},o.send(r||null),n.timeout=setTimeout(s,5e3)}function s(e){e.abort()}function u(){this.dfd.notify()}function a(){var e=this,t=e.xhr,r=e.dfd;4===t.readyState&&(clearTimeout(e.timeout),200===t.status?r.resolve(t.responseText,t):r.reject(t.status,t))}function p(e,t){var r,n,o,i="",s=[];for(r in e)n=t?"".concat(t,"[",r,"]"):r,o=e[r],s.push("object"==typeof v?p(o,n):"".concat(encodeURIComponent(n),"=",encodeURIComponent(o)));return i.concat.apply(i,s)}var d;return d=e.extend({load:function(e,n,s,u){var a={};return u=u||!0,n=u===!0?"".concat(n,n.indexOf("?")>-1?"&":"?","_="+(new Date).getTime()):n,a.id=t.string(),a.dfd=r.defer(),a.xhr=o(),a.timeout=null,i.apply(a,[e.toUpperCase(),n,s]),a.dfd.promise},get:function(e,t,r){return this.load("GET",e,t,r)},post:function(e,t,r){return this.load("POST",e,t,r)},put:function(e,t,r){return this.load("PUT",e,t,r)},"delete":function(e,t,r){return this.load("DELETE",e,t,r)},head:function(e,t,r){return this.load("HEAD",e,t,r)}})},window,document);