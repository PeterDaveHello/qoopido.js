(function(e,t){"use strict";var n="qoopido/xhr",r=function r(){return t.qoopido.shared.prepareModule(n,e,arguments,!0)};"function"==typeof define&&define.amd?define(["qoopido/base","qoopido/unique","q"],r):r(t.qoopido.base,t.qoopido.unique,t.Q)})(function(e,t,n,r){"use strict";function o(e){if("object"==typeof e){var t;for(t in e)f[t]!==undefined&&(f[t]=e[t])}}function i(e){var t,n=this;e="object"==typeof e?e:{};for(t in f)n.settings[t]=e[t]||f[t]}function s(e,t,n){var r,o=this,i=o.xhr,s=o.settings;n="object"==typeof n?c(n):n,t=s.cache===!1?"".concat(t,t.indexOf("?")>-1?"&":"?","_="+(new Date).getTime()):t,t=n&&"GET"===e?"".concat(t,t.indexOf("?")>-1?"&":"?",n):t;for(r in s.xhrOptions)i[r]=s.xhrOptions[r];i.open(e,t,s.async,s.username,s.password),i.setRequestHeader("Accept",s.accept),n&&"GET"!==e&&i.setRequestHeader("Content-type",s.contentType);for(r in s.header)i.setRequestHeader(r,s.header[r]);i.timeout=s.timeout,i.onprogress=function(){a.apply(o)},i.onreadystatechange=function(){p.apply(o)},i.send(n||null),o.timeout=setTimeout(u,s.timeout)}function u(e){e.abort()}function a(){this.dfd.notify()}function p(){var e=this,t=e.xhr,n=e.dfd;4===t.readyState&&(clearTimeout(e.timeout),200===t.status?n.resolve(t.responseText,t):n.reject(t.status,t))}function c(e,t){var n,r,o,i="",s=[];for(n in e)r=t?"".concat(t,"[",n,"]"):n,o=e[n],s.push("object"==typeof v?c(o,r):"".concat(encodeURIComponent(r),"=",encodeURIComponent(o)));return i.concat.apply(i,s)}var d,f={accept:"*/*",timeout:5e3,async:!0,cache:!1,header:{},username:null,password:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8 ",xhrOptions:{}},l=r.XMLHttpRequest!==undefined?function(){return new r.XMLHttpRequest}:function(){try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}};return d=e.extend({setup:function(e){return o(e),this},load:function(e,r,o,u){var a={};return a.id=t.string(),a.dfd=n.defer(),a.xhr=l(),a.timeout=null,a.settings={},i.apply(a,[u]),s.apply(a,[e.toUpperCase(),r,o]),a.dfd.promise},get:function(e,t,n){return this.load("GET",e,t,n)},post:function(e,t,n){return this.load("POST",e,t,n)},put:function(e,t,n){return this.load("PUT",e,t,n)},"delete":function(e,t,n){return this.load("DELETE",e,t,n)},head:function(e,t,n){return this.load("HEAD",e,t,n)}})},window,document);