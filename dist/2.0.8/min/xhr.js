(function(e,t){"use strict";var r="qoopido/xhr",o=function o(){return t.qoopido.shared.prepareModule(r,e,arguments,!0)};"function"==typeof define&&define.amd?define(["qoopido/base","qoopido/unique","q"],o):o(t.qoopido.base,t.qoopido.unique,t.Q)})(function(e,t,r,o){"use strict";function n(){if(o.XMLHttpRequest)return new o.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}}function i(e,t,r){var o=this,n=o.xhr;r="object"==typeof r?p(r):r,t=r&&"GET"===e?"".concat(t,t.indexOf("?")>-1?"&":"?",r):t,n.open(e,t,!0,null,null),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&"GET"!==e&&n.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8 "),n.setRequestHeader("Accepts","application/json"),n.timeout=5200,n.onprogress=function(){u.apply(o)},n.onreadystatechange=function(){a.apply(o)},n.send(r||null),o.timeout=setTimeout(s,5e3)}function s(e){e.abort()}function u(){this.dfd.notify()}function a(){var e=this,t=e.xhr,r=e.dfd;4===t.readyState&&(clearTimeout(e.timeout),200===t.status?r.resolve(t.responseText,t):r.reject(t.status,t))}function p(e,t){var r,o,n,i="",s=[];for(r in e)o=t?"".concat(t,"[",r,"]"):r,n=e[r],s.push("object"==typeof v?p(n,o):"".concat(encodeURIComponent(o),"=",encodeURIComponent(n)));return i.concat.apply(i,s)}var d;return d=e.extend({load:function(e,o,s,u){var a={};return u=u||!0,o=u===!0?"".concat(o,o.indexOf("?")>-1?"&":"?","_="+(new Date).getTime()):o,a.id=t.string(),a.dfd=r.defer(),a.xhr=n(),a.timeout=null,i.apply(a,[e.toUpperCase(),o,s]),a.dfd.promise},get:function(e,t,r){return this.load("GET",e,t,r)},post:function(e,t,r){return this.load("POST",e,t,r)},put:function(e,t,r){return this.load("PUT",e,t,r)},"delete":function(e,t,r){return this.load("DELETE",e,t,r)},head:function(e,t,r){return this.load("HEAD",e,t,r)}})},window,document);