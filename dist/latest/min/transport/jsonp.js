(function(e,t){"use strict";function n(){return t.qoopido.initialize("transport/jsonp",e,arguments,!0)}"function"==typeof define&&define.amd?define(["../transport","../function/merge","../function/unique/uuid","../url","../dom/element","../pool/dom","q"],n):n()})(function(e,t,n,i,o){"use strict";function r(e,t){var n=this,o=n.dfd,r=n.script,a=n.settings;t="object"==typeof t?n.serialize(t):t,e="".concat(e,e.indexOf("?")>-1?"&":"?","".concat(a.callback,"=",n.id)),e=a.cache===!1?"".concat(e,e.indexOf("?")>-1?"&":"?","".concat("_=",""+(new Date).getTime())):e,e=t?"".concat(e,e.indexOf("?")>-1?"&":"?",t):e,i[n.id]=function(e){o.resolve(e);try{delete i[n.id]}catch(t){i[n.id]=null}},r.on("load readystatechange",function(e){u.call(n,e)}).one("error",function(){s.call(n)}).setAttribute("src",e),f.appendChild(r.element)}function u(e){var t=this,n=t.dfd;e.readyState&&"loaded"!==e.readyState&&"complete"!==e.readyState||(t.script.off().element.dispose(),t.timeout=setTimeout(function(){a.call(t)},t.settings.timeout)),n.notify(e)}function s(){var e=this;e.script.off().element.dispose(),e.dfd.reject()}function a(){this.dfd.reject()}var c,l=i.Q||t[4],f=o.getElementsByTagName("head")[0];return c=e.transport.extend({_settings:{callback:"callback",cache:!1,timeout:200},load:function(t,n,o){var u={};return t=e.url.resolve(t),u.id="".concat("jsonp-",e["function/unique/string"]()),u.dfd=l.defer(),u.script=e["dom/element"].create(i.qoopido.shared.pool.dom.obtain("script")),u.settings=e["function/merge"]({},this._settings,o),u.timeout=null,u.script.setAttribute("async",!0),r.call(u,t,n),u.dfd.promise}})},window,document);