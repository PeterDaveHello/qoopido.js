(function(e,t){"use strict";function n(){return t.qoopido.shared.module.initialize("transport/xhr",e,arguments,!0)}"function"==typeof define&&define.amd?define(["../transport","../function/merge","../url","../unique","q"],n):n(t.qoopido.transport,t.qoopido.function.merge,t.qoopido.url,t.qoopido.unique,t.Q)})(function(e,t,n,r,o,i,s){"use strict";function u(e,t,n){var r,o=this,i=o.xhr,s=o.settings;n="object"==typeof n?o.serialize(n):n,t=s.cache===!1?"".concat(t,t.indexOf("?")>-1?"&":"?","_="+(new Date).getTime()):t,t=n&&"GET"===e?"".concat(t,t.indexOf("?")>-1?"&":"?",n):t;for(r in s.xhrOptions)i[r]=s.xhrOptions[r];i.open(e,t,s.async,s.username,s.password),i.setRequestHeader("Accept",s.accept),n&&"GET"!==e&&i.setRequestHeader("Content-Type",s.contentType);for(r in s.header)i.setRequestHeader(r,s.header[r]);i.timeout=s.timeout,i.onprogress=function(e){c.call(o,e)},i.onreadystatechange=function(){l.call(o)},i.onerror=function(){f.call(o)},i.send(n||null),o.timeout=setTimeout(function(){a(i)},s.timeout)}function a(e){e.abort()}function c(e){this.dfd.notify(e.loaded/e.total)}function l(){var e=this,t=e.xhr,n=e.dfd;4===t.readyState&&(d.call(e),200===t.status?n.resolve({data:t.responseText,xhr:t}):n.reject({status:t.status,xhr:t}))}function f(){var e=this;d.call(e),e.dfd.reject()}function d(){var e=this,t=e.xhr;clearTimeout(e.timeout),t.onprogress=t.onreadystatechange=t.onerror=null}var p,m=s.XMLHttpRequest!==undefined?function(e){return n.isLocal(e)?new s.XMLHttpRequest:s.XDomainRequest?new s.XDomainRequest:new s.XMLHttpRequest}:function(){try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}};return p=e.extend({_settings:{accept:"*/*",timeout:5e3,async:!0,cache:!1,header:{},username:null,password:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8 ",xhrOptions:{}},load:function(e,i,s,a){var c={};return i=n.resolve(i),c.id="".concat("xhr-",r.string()),c.dfd=o.defer(),c.xhr=m(i),c.timeout=null,c.settings=t({},this._settings,a),u.apply(c,[e.toUpperCase(),i,s]),c.dfd.promise},get:function(e,t,n){return this.load("GET",e,t,n)},post:function(e,t,n){return this.load("POST",e,t,n)},put:function(e,t,n){return this.load("PUT",e,t,n)},"delete":function(e,t,n){return this.load("DELETE",e,t,n)},head:function(e,t,n){return this.load("HEAD",e,t,n)}})},window,document);