(function(e,t){"use strict";var n=function n(){return t.qoopido.shared.module.initialize("module/emerge",e,arguments)};"function"==typeof define&&define.amd?define(["../emitter","../unique","../element","../function/merge"],n):n(t.qoopido.emitter,t.qoopido.unique,t.qoopido.element,t.qoopido.function.merge)})(function(e,t,n,r,i,o,u,a){"use strict";function c(e){var t,n=v[e];for(t in n)"length"!==t&&f.call(n[t]);0===n.length&&(o.clearInterval(y[e]),delete y[e])}function s(){g.left=0,g.top=0,g.right=m.clientWidth,g.bottom=m.clientHeight}function l(){var e=this,t=e._settings.threshold||m.clientWidth*e._settings.auto,n=e._settings.threshold||m.clientHeight*e._settings.auto;e._viewport.left=g.left-t,e._viewport.top=g.top-n,e._viewport.right=g.right+t,e._viewport.bottom=g.bottom+n}function f(){var e,t=this,n=!1,r=2;!t._element.isVisible()||"hidden"===t._element.style.visibility&&t._settings.visibility!==!1||(e=t._element.getBoundingClientRect(),(e.left>=t._viewport.left&&e.top>=t._viewport.top&&e.left<=t._viewport.right&&e.top<=t._viewport.bottom||e.right>=t._viewport.left&&e.bottom>=t._viewport.top&&e.right<=t._viewport.right&&e.bottom<=t._viewport.bottom)&&((e.left>=g.left&&e.top>=g.top&&e.left<=g.right&&e.top<=g.bottom||e.right>=g.left&&e.bottom>=g.top&&e.right<=g.right&&e.bottom<=g.bottom)&&(r=1),n=!0)),(n!==t._state||r!==t._priority)&&p.call(t,n,r)}function p(e,t){var n=this;n._state=e,n._priority=t,n._settings.recur!==!0&&n.remove(),e===!0?n.emit(b,t):n.emit(_)}var d,h={interval:50,threshold:"auto",recur:!0,auto:.5,visibility:!0},m=o.document.documentElement,g={},y={},v={},b="emerged",_="demerged",w="resize orientationchange";if(o=n.create(o),"CSS1Compat"!==u.compatMode)throw"This script requires your browser to work in standards mode";return d=e.extend({_viewport:null,_uuid:null,_element:null,_settings:null,_state:null,_priority:null,_constructor:function(e,i){var u=this;d._parent._constructor.apply(u,arguments),i=r({},h,i||{}),"auto"===i.threshold&&delete i.threshold,y[i.interval]===a&&(v[i.interval]=v[i.interval]||{length:0},y[i.interval]=o.setInterval(function(){c(i.interval)},i.interval)),u._viewport={},u._uuid=t.uuid(),u._element=n.create(e),u._settings=i,u._state=!1,u._priority=2,v[i.interval][u._uuid]=u,v[i.interval].length++,o.on(w,function(){l.call(u)}),l.call(u)},remove:function(){var e=this;delete v[e._settings.interval][e._uuid],v[e._settings.interval].length--}}),o.on(w,s),s(),d},window);