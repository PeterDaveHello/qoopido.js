(function(e,t){"use strict";var n=function n(){return t.qoopido.shared.module.initialize("element/emerge",e,arguments)};"function"==typeof define&&define.amd?define(["../element","../function/merge","../unique"],n):n(t.qoopido.element,t.qoopido.function.merge,t.qoopido.unique)})(function(e,t,n,r,i,o,l){"use strict";function u(e){var t,n=m[e];for(t in n)"length"!==t&&f.call(n[t]);0===n.length&&(i.element.clearInterval(y[e]),delete y[e])}function c(){h.left=0,h.top=0,h.right=v.clientWidth,h.bottom=v.clientHeight}function s(){var e=this,t=e._settings.threshold||v.clientWidth*e._settings.auto,n=e._settings.threshold||v.clientHeight*e._settings.auto;e._viewport.left=h.left-t,e._viewport.top=h.top-n,e._viewport.right=h.right+t,e._viewport.bottom=h.bottom+n}function f(){var e,t=this,n=!1,r=2;!t.isVisible()||"hidden"===t.getStyle("visibility")&&t._settings.visibility!==!1||(e=t.element.getBoundingClientRect(),(e.left>=t._viewport.left&&e.top>=t._viewport.top&&e.left<=t._viewport.right&&e.top<=t._viewport.bottom||e.right>=t._viewport.left&&e.bottom>=t._viewport.top&&e.right<=t._viewport.right&&e.bottom<=t._viewport.bottom)&&((e.left>=h.left&&e.top>=h.top&&e.left<=h.right&&e.top<=h.bottom||e.right>=h.left&&e.bottom>=h.top&&e.right<=h.right&&e.bottom<=h.bottom)&&(r=1),n=!0)),(n!==t._state||r!==t._priority)&&a.call(t,n,r)}function a(e,t){var n=this;n._state=e,n._priority=t,n._settings.recur!==!0&&n.remove(),e===!0?n.emit(g,t):n.emit(b)}var p,d={interval:50,threshold:"auto",recur:!0,auto:.5,visibility:!0},v=i.document.documentElement,h={},y={},m={},g="emerged",b="demerged",_="resize orientationchange";if(i=e.create(i),"CSS1Compat"!==o.compatMode)throw"This script requires your browser to work in standards mode";return p=e.extend({_viewport:null,_uuid:null,_element:null,_settings:null,_state:null,_priority:null,_constructor:function(e,r){var o=this;p._parent._constructor.call(o,e),r=t({},d,r||{}),"auto"===r.threshold&&delete r.threshold,y[r.interval]===l&&(m[r.interval]=m[r.interval]||{length:0},y[r.interval]=i.element.setInterval(function(){u(r.interval)},r.interval)),o._viewport={},o._uuid=n.uuid(),o._settings=r,o._state=!1,o._priority=2,m[r.interval][o._uuid]=o,m[r.interval].length++,i.on(_,function(){s.call(o)}),s.call(o)},remove:function(){var e=this;delete m[e._settings.interval][e._uuid],m[e._settings.interval].length--}}),i.on(_,c),c(),p},window);