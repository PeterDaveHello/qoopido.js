(function(e,t){"use strict";var r="qoopido/support",n=function n(){return t.qoopido.shared.prepareModule(r,e,arguments)};"function"==typeof define&&define.amd?define(["./base","q"],n):n(t.qoopido.base,t.Q)})(function(e,t,r,n,o){"use strict";function i(){return arguments.length>1?arguments[1].toUpperCase():arguments[0].charAt(0).toUpperCase()+arguments[0].slice(1)}var s=/-([a-z])/gi,u={prefix:null,property:{},method:{},element:{},promises:{prefix:null,property:{},method:{},test:{}}};return e.extend({test:{},testMultiple:function(){var e,r=[],n=0;for(n;(e=arguments[n])!==o;n++)switch(typeof e){case"string":r.push(this.test[e]());break;case"boolean":var i=t.defer();e?i.resolve():i.reject(),r.push(i.promise);break;default:r.push(e)}return t.all(r)},getElement:function(e,t){var r=u.element[e]=u.element[e]||"image"!==e?n.createElement(e):new Image;return t=!!t,t?r.cloneNode(!1):r},getPrefix:function(){var e,t=u.prefix||null;if(null===t){var r=this.getElement("div").style,n=/^(Moz|WebKit|Khtml|ms|O|Icab)(?=[A-Z])/;t=!1;for(e in r)n.test(e)&&(t=e.match(n)[0]);t===!1&&"WebkitOpacity"in r&&(t="WebKit"),t===!1&&"KhtmlOpacity"in r&&(t="Khtml"),t=u.prefix=t===!1?!1:{method:t,properties:[t.toLowerCase(),i(t.toLowerCase())]}}return t},getProperty:function(e){e=e.replace(s,i);var t=u.property[e]||null;if(null===t){t=!1;var r,n=0,a=this.getElement("div"),c=i(e),p=(this.getPrefix()||{properties:[]}).properties,f=(e+" "+p.join(c+" ")+c).split(" ");for(n;(r=f[n])!==o;n++)if(a.style[r]!==o){t=r;break}u.property[e]=t}return t},getMethod:function(e,t){t=t||r;var n=t.tagName,s=u.method[n]=u.method[n]||{},a=s[e]=u.method[n][e]||null;if(null===a){a=!1;var c,p,f=0,l=i(e),d=this.getPrefix();for(c=d!==!1?(e+" "+d.method+l+" "+d.properties.join(l+" ")+l).split(" "):[e],f;(p=c[f])!==o;f++)if(t[p]!==o&&("function"==typeof t[p]||"object"==typeof t[p])){a=p;break}u.method[n][e]=a}return a},supportsPrefix:function(){return!!this.getPrefix()},supportsProperty:function(e){return!!this.getProperty(e)},supportsMethod:function(e,t){return!!this.getMethod(e,t)},testPrefix:function(){var e=u.promises.prefix;if(null===e){var r=t.defer(),n=this.getPrefix();n?r.resolve(n):r.reject(),e=u.promises.prefix=r.promise}return e},testProperty:function(e){var r=u.promises.property[e]||null;if(null===r){var n=t.defer(),o=this.getProperty(e);o?n.resolve(o):n.reject(),r=u.promises.property[e]=n.promise}return r},testMethod:function(e,n){n=n||r;var o=n.tagName,i=u.promises.method[o]=u.promises.method[o]||{},s=i[e]=u.promises.method[o][e]||null;if(null===s){var a=t.defer(),c=this.getMethod(e,n);c?a.resolve(c):a.reject(),s=u.promises.method[o][e]=a.promise}return s},addTest:function(e,r){return this.test[e]=function(){var n=u.promises.test[e]||null;if(null===n){var o=t.defer(),i=Array.prototype.slice.call(arguments);i.splice(0,0,o),r.apply(null,i),n=u.promises.test[e]=o.promise}return n}}})},window,document);